.code

EXTERN SW3_GetSyscallNumber: PROC

EXTERN SW3_GetRandomSyscallAddress: PROC

NtProtectVirtualMemory PROC
        mov [rsp +8], rcx          ; Save registers.
        mov [rsp+16], rdx
        mov [rsp+24], r8
        mov [rsp+32], r9
        sub rsp, 28h
        mov ecx, 0059E1501h        ; Load function hash into ECX.
        call SW3_GetRandomSyscallAddress        ; Get a syscall offset from a different api.
        mov r15, rax                           ; Save the address of the syscall
        mov ecx, 0059E1501h        ; Re-Load function hash into ECX (optional).
        call SW3_GetSyscallNumber              ; Resolve function hash into syscall number.
        add rsp, 28h
        mov rcx, [rsp+8]                      ; Restore registers.
        mov rdx, [rsp+16]
        mov r8, [rsp+24]
        mov r9, [rsp+32]
        mov r10, rcx
        jmp r15                                ; Jump to -> Invoke system call.
NtProtectVirtualMemory ENDP

NtCreateThreadEx PROC
        mov [rsp +8], rcx          ; Save registers.
        mov [rsp+16], rdx
        mov [rsp+24], r8
        mov [rsp+32], r9
        sub rsp, 28h
        mov ecx, 0C3231E07h        ; Load function hash into ECX.
        call SW3_GetRandomSyscallAddress        ; Get a syscall offset from a different api.
        mov r15, rax                           ; Save the address of the syscall
        mov ecx, 0C3231E07h        ; Re-Load function hash into ECX (optional).
        call SW3_GetSyscallNumber              ; Resolve function hash into syscall number.
        add rsp, 28h
        mov rcx, [rsp+8]                      ; Restore registers.
        mov rdx, [rsp+16]
        mov r8, [rsp+24]
        mov r9, [rsp+32]
        mov r10, rcx
        jmp r15                                ; Jump to -> Invoke system call.
NtCreateThreadEx ENDP

NtWaitForSingleObject PROC
        mov [rsp +8], rcx          ; Save registers.
        mov [rsp+16], rdx
        mov [rsp+24], r8
        mov [rsp+32], r9
        sub rsp, 28h
        mov ecx, 0382758FBh        ; Load function hash into ECX.
        call SW3_GetRandomSyscallAddress        ; Get a syscall offset from a different api.
        mov r15, rax                           ; Save the address of the syscall
        mov ecx, 0382758FBh        ; Re-Load function hash into ECX (optional).
        call SW3_GetSyscallNumber              ; Resolve function hash into syscall number.
        add rsp, 28h
        mov rcx, [rsp+8]                      ; Restore registers.
        mov rdx, [rsp+16]
        mov r8, [rsp+24]
        mov r9, [rsp+32]
        mov r10, rcx
        jmp r15                                ; Jump to -> Invoke system call.
NtWaitForSingleObject ENDP

NtWriteVirtualMemory PROC
        mov [rsp +8], rcx          ; Save registers.
        mov [rsp+16], rdx
        mov [rsp+24], r8
        mov [rsp+32], r9
        sub rsp, 28h
        mov ecx, 0DBD522A6h        ; Load function hash into ECX.
        call SW3_GetRandomSyscallAddress        ; Get a syscall offset from a different api.
        mov r15, rax                           ; Save the address of the syscall
        mov ecx, 0DBD522A6h        ; Re-Load function hash into ECX (optional).
        call SW3_GetSyscallNumber              ; Resolve function hash into syscall number.
        add rsp, 28h
        mov rcx, [rsp+8]                      ; Restore registers.
        mov rdx, [rsp+16]
        mov r8, [rsp+24]
        mov r9, [rsp+32]
        mov r10, rcx
        jmp r15                                ; Jump to -> Invoke system call.
NtWriteVirtualMemory ENDP

NtAllocateVirtualMemory PROC
        mov [rsp +8], rcx          ; Save registers.
        mov [rsp+16], rdx
        mov [rsp+24], r8
        mov [rsp+32], r9
        sub rsp, 28h
        mov ecx, 0C0503A2Dh        ; Load function hash into ECX.
        call SW3_GetRandomSyscallAddress        ; Get a syscall offset from a different api.
        mov r15, rax                           ; Save the address of the syscall
        mov ecx, 0C0503A2Dh        ; Re-Load function hash into ECX (optional).
        call SW3_GetSyscallNumber              ; Resolve function hash into syscall number.
        add rsp, 28h
        mov rcx, [rsp+8]                      ; Restore registers.
        mov rdx, [rsp+16]
        mov r8, [rsp+24]
        mov r9, [rsp+32]
        mov r10, rcx
        jmp r15                                ; Jump to -> Invoke system call.
NtAllocateVirtualMemory ENDP

NtQuerySystemInformation PROC
        mov [rsp +8], rcx          ; Save registers.
        mov [rsp+16], rdx
        mov [rsp+24], r8
        mov [rsp+32], r9
        sub rsp, 28h
        mov ecx, 01F958098h        ; Load function hash into ECX.
        call SW3_GetRandomSyscallAddress        ; Get a syscall offset from a different api.
        mov r15, rax                           ; Save the address of the syscall
        mov ecx, 01F958098h        ; Re-Load function hash into ECX (optional).
        call SW3_GetSyscallNumber              ; Resolve function hash into syscall number.
        add rsp, 28h
        mov rcx, [rsp+8]                      ; Restore registers.
        mov rdx, [rsp+16]
        mov r8, [rsp+24]
        mov r9, [rsp+32]
        mov r10, rcx
        jmp r15                                ; Jump to -> Invoke system call.
NtQuerySystemInformation ENDP

end                                                                                                                                                                                     
